# vPlanSim
An Open Source Graphical Interface for the Visualisation and Simulation of AI Systems


System architecture

vPlanSim uses VTK to visualise the generated scene. The walls and obstacles use the vtkPropAssembly class to encapsulate vtkActor objects and vtkCaptionActor2D objects. The floor panels make use of the vtkActor class as well. The colour properties of the vtkActor objects are manipulated to differentiate entry and goal points, and the positions of the objects can be calculated on demand. An undo/redo stack allows for actions to be removed or replayed as necessary. Lists (i.e. Python List) of wall positions, entry points, and goal points can be generated by scanning the VTK colour and position properties of the various objects in the scene.
The GUI can be used to add exterior and interior walls by setting the required dimensions. Obstacles, goal and entry points can be defined by entering a point (i.e. PyQt UI) and click mode or by specifying the exact position in the scene (i.e. VTK window). Wall and floor objects can be removed entirely by selecting the delete mode or by clicking on a specific block to be deleted. The floor panels of the scene, annotations noting the positions of the wall blocks, the X, Y, and Z axes can be set to be visible or not.



When first executed, the tool initialises two vtkRenderer objects, one for the scene blocks and another for annotations such as the grid and axes. Scaling and rotation of the scene is enabled through VTK window interactions.
All the walls and obstacles are composed of vtkPropAssembly objects which encapsulate a vtkActor of size 1x1x1 and a vtkCaptionActor2D. The vtkCaptionActor2D holds the text representation of the position of the cube. The floor panels are vtkActor objects with a width and a depth of 1 and a much smaller height to give the impression of a flat and thin surface. The use of floor is mainly for the user interaction when obstacles, goals or entry points are selected.

Standard VTK colour properties are used to differentiate the entry and goal points. Creation of the outside walls takes three inputs from the GUI, representing the width, height, and depth of the outside walls. These are rendered along the X, Y, and Z axes respectively. Looping over the values, a vtkPropAssembly object for each section of the outside walls is added and then the scene is rendered. It is initially assumed that the scene will have a floor. Adding interior walls is divided into two functions allowing the addition of walls along the X axis or along the Z axis. The starting position along the X or Z axis along with the height and length of the walls are taken from inputs in the GUI. The delete blocks module uses a vtkPicker class to interpret mouse clicks on the scene. As objects are selected they are removed from the vtkRenderer and the scene is updated. Undo and redo functionality in provided through the inclusion of two basic action stacks, implemented as Python Lists. As actions are taken on the scene the reverse of that action is pushed into the undo list, along with the relevant actor details. When the undo function is used the actions are again reversed and saved in the redo stack so that they can be replayed if requested. On demand, the scene can be scanned to calculate the positions and type of each object. The entry points and goals are differentiated by their colour properties. Separate lists of the wall objects, entry points and goals can be generated. Obstacles can be added to the scene by specifying the geometry directly in the GUI, or by entering a selection mode, clicking on the scene at the point the obstacle should be created and clicking save. The vtkPicker class is used to determine where the user has clicked in the scene. The entry point and goals can similarly be created by the user through point and click or by directly setting a position in the GUI.
